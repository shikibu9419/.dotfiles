#!/bin/bash

check-git-available() {
  $(git rev-parse > /dev/null 2>&1) || error 'fatal: not a git repository.'
}

check-availables() {
  for cmd in $@; do
    has $cmd || error "fatal: $cmd is not installed."
  done
}

has() {
  return $(type "$1" > /dev/null 2>&1)
}

error() {
  echo $1 1>&2
  exit 1
}

confirm() {
  printf "$1 (y/N): "
  if read -q; then
    echo; return 0
  else
    echo; return 1
  fi
}

set-fuzzy-finder() {
  finders='fzf-tmux:fzf:peco:percol:gof'
  while [ -n $finders ]; do
    finder=${finders%%:*}
    finders=${finders#*:}
    if has $finder; then
      echo $finder
      return
    fi
  done

  cat <<EOF
This command requires FUZZY FINDER. Either of these is necessary.
fzf, fzf-tmux, peco, percol, gof
EOF
  exit 1
}
